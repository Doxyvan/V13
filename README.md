# Контрастивный автоэнкодер

## Цель работы
Совместить реконструкцию и контрастивное сближение близких примеров в рамках автоэнкодера.

## Описание метода
Функция потерь: `L = L_recon + λ · L_contrast`, где позитивные пары — разные аугментации одного изображения.

## Архитектура модели

```python
class Autoencoder(nn.Module):
    def __init__(self, latent_dim=32):
        super().__init__()
        self.latent_dim = latent_dim
        
        # Энкодер
        self.encoder = nn.Sequential(
            nn.Conv2d(1, 32, 3, stride=2, padding=1),
            nn.ReLU(),
            nn.Conv2d(32, 64, 3, stride=2, padding=1),
            nn.ReLU(),
            nn.Flatten(),
            nn.Linear(64*7*7, latent_dim)
        )
        
        # Декодер
        self.decoder = nn.Sequential(
            nn.Linear(latent_dim, 64*7*7),
            nn.Unflatten(1, (64, 7, 7)),
            nn.ConvTranspose2d(64, 32, 3, stride=2, padding=1, output_padding=1),
            nn.ReLU(),
            nn.ConvTranspose2d(32, 1, 3, stride=2, padding=1, output_padding=1),
            nn.Sigmoid()
        )
```
Параметры:
- Размерность латентного вектора: 32
- Batch size: 128 (обучение), 1000 (тестирование)
- Проекция латентного пространства: 2D (t-SNE)

Проведенные эксперименты:
Эксперимент 1
λ: [0.1, 0.5, 1.0]
Аугментация: поворот ±10%, контрастность ±20%
Эпохи: 1

Эксперимент 2
λ: [0.1, 0.5, 1.0]
Аугментация: поворот ±10%, контрастность ±20%
Эпохи: 5

Эксперимент 3
λ: [0.1, 0.5, 1.0]
Температура: [0.07, 0.1, 0.2]
Аугментация:
- Поворот ±20°
- Контрастность 0.6-1.4
- Сдвиг ±15% по осям
- Масштаб 0.7-1.3
- Шум 10%
Эпохи: 5

Результаты:
Всего проведено 15 прогонов модели. Для каждого эксперимента получены:
График латентного пространства - визуализация через t-SNE
Примеры изображений в формате:
Строка 1: оригинальные изображения (8 столбцов)
Строка 2: аугментированные версии
Строка 3: реконструкции

Структура проекта
main.py - основной скрипт обучения
autoencoder.py - реализация автоэнкодера
augmentation.py - функции аугментации
models/ - сохраненные модели
results/ - графики и визуализации
